define(["base"],function(e){return e.extend({fnHtmlAlert:function(i){function t(){}var s={};s.create=function(t){this.state&&alert("dialog存在，不能进行create");var s=[],n=i.id||"J_"+(new Date).getTime();s.push('<div class="mui-dialog" id="'+n+'">');var o=i.customClass||"";e.isDevicePhone()&&s.push("<div class='mui-fix-phone-scroll'></div>"),s.push('<div class="mui-dialog-inner '+o+' clearfix">'),s.push(t),s.push('</div><span class="after"></span></div>');var a=s.join("");this.$wrapBody||(this.$wrapBody=e("#J_wrapBody")),this.$dom=e(a),this.$wrapBody.append(this.$dom),this.fixIeFrame("show"),this.createEvent(i.cancel,i.confirm),this.fixManyDialog(),e.isDevicePhone()&&(i.isMove&&this.move(),e(document).delegate(".mui-fix-phone-scroll","touchstart touchmove",function(e){e&&event.preventDefault()})),this.state=!0},s.fill=function(t){if(e.extend(i,t),this.$dom){this.$dom.find(".mui-dialog-inner").html(i.content),this.createEvent(i.cancel,i.confirm)}},s.close=function(){this.state||alert("dialog不存在,请创建"),this.$dom.addClass("hide"),this.fixIeFrame("hide"),this.fixManyDialog("hide")},s.show=function(){this.state||alert("dialog不存在,请创建"),this.$dom.removeClass("hide"),this.fixIeFrame("show"),this.fixManyDialog()},s.remove=function(){this.fixIeFrame("show"),this.$dom.remove(),this.state=!1},s.fixIeFrame=function(i){if(this.brower=e.browerV(),this.brower.ie<"9.0"){this.$frame||(this.$frame=e("#ifr_cover,#alertBoxWrap").removeClass("hide")),i&&this.$dom[i]();for(var t=1e4,s=0,n=this.$wrapBody.find(".mui-dialog"),o=0,a=n.length;o<a&&a>1;o++){var r=n.eq(o);if(!r.hasClass("hide")){s++;var h=r.css("z-index");"number"!=typeof h&&(h=parseInt(h,10)),h>t&&(t=h),t+=3}}"show"===i||"hide"===i&&s>0?("show"===i?(this.$frame.show(),this.$dom.css({"z-index":t})):t-=3,this.$frame.eq(0).css({"z-index":t-2}),this.$frame.eq(1).css({"z-index":t-1}),this.$wrapBody.css({overflow:"hidden"})):(this.$frame.hide(),this.$wrapBody.css({overflow:"scroll"}))}},s.createEvent=function(e,i){var t=this,s=t.$dom.find(".c_close");s.length>0&&s.bind("click",function(){return e?e(t):t.close(t),!1});var n=t.$dom.find(".c_confirm");n&&n.length>0&&n.bind("click",function(){return i?i(t):t.close(t),!1})},s.fixManyDialog=function(){for(var e=1e4,i=this.$wrapBody.find(".mui-dialog"),t=0,s=i.length;t<s&&s>1;t++){var n=i.eq(t);if(!n.hasClass("hide")){var o=n.css("z-index");"number"!=typeof o&&(o=parseInt(o,10)),o>e&&(e=o),e+=3}}this.$dom.css({"z-index":e})},s.move=function(){var e,i=this,t=i.$dom,s=t.find(".mui-dialog-inner");i.contentHeight||(i.contentHeight=s.height()),s.on("touchstart",function(i){e=i.originalEvent.changedTouches[0].pageY}),s.on("touchmove",function(i){var t=parseInt(i.originalEvent.changedTouches[0].pageY,10),n=t-e;s.css("top",n)})},t.prototype=s;var n=new t;return n.create(i.content),n}}),e.fnHtmlAlert});